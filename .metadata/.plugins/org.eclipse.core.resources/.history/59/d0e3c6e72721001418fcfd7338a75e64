package kesaprojekti.remotelights;

import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

import android.content.Context;
import android.support.v7.appcompat.R.integer;
import android.widget.Toast;


public class ConnectionHandler extends Thread implements Runnable {
	private int	address;
	Context	context;
	
	public ConnectionHandler(Context context)	{
		this.context = context;
	}
	
	
	public void start(int address)	{
		this.address = address;
		start();
	}

	@Override
	public void run() {
		new Thread(new Runnable() {
			
			@Override
			public void run() {
				
				String serverName = "10.240.147.159";
			    int port = 4444;
			    try
			      {
			    	String string = "";
			    	int i = 0;
			    	 
			    	 
			    	 Socket client = new Socket(serverName, port);

			         OutputStream outToServer = client.getOutputStream();
			         DataOutputStream out =
			                       new DataOutputStream(outToServer);
			         out.write((address + "\n").getBytes());

			         InputStream inFromServer = client.getInputStream();
			         DataInputStream in =
			                        new DataInputStream(inFromServer);
			         
//			         if (in.available() != 0)	{
//			        	 int recieved = 0;
//			             recieved = in.read();
//			            if(recieved != '\n'){
//			              string += recieved;
//			            }
//			            if(recieved == '\n'){
//			              i = Integer.parseInt(string);
//			              Toast.makeText(context,
//			                       i, Toast.LENGTH_LONG)
//			                       .show();
//			              string = "";          
//			            }
//			        	 
//			         }
			         
			         
			         
			         Helper h = new Helper();
			         h.saveStatus(i, "status", context);
			         	         
			         client.close();
			         
			      }catch(IOException e)
			      {
			         e.printStackTrace();
			      }
				
			}
			
			
		}).start();
		
	}
	
	
	
	

}
